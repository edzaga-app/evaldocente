<div class="expanded-container">
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <p class="description-item">Preguntas de la Heteroevaluación</p>
  </div>
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <div fxFlex="35">
      <mat-form-field>
        <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Buscar pregunta" #input>
      </mat-form-field>
    </div>
  </div>
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <div fxFlex="99">
      <div class="questions-table-container mat-elevation-z6">
        <table mat-table [dataSource]="dataQuestions">

          <!-- Pregunta -->
          <ng-container matColumnDef="question">
            <th mat-header-cell *matHeaderCellDef> Pregunta </th>
            <td mat-cell *matCellDef="let element"> {{element.question}} </td>
          </ng-container>

          <!-- Contenido -->
          <ng-container matColumnDef="content">
            <th mat-header-cell *matHeaderCellDef> Contenido </th>
            <td mat-cell *matCellDef="let element"> {{element.content}} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="questionsColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: questionsColumns;"></tr>

          <!-- Fila a mostrar cuando no encuentra datos -->
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="5" *ngIf="isFilter">No hay datos que coincidan con el filtro "{{input.value}}"</td>
          </tr>

        </table>

        <mat-card *ngIf="isLoading" style="display: flex; justify-content: center; align-items: center">
          <mat-progress-spinner  color="primary" mode="indeterminate"></mat-progress-spinner>
        </mat-card>
        <mat-paginator [pageSize]="7" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>

      </div>
    </div>
  </div>
  <br>
  <!-- Resultados Heteroevaluación -->
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <p class="description-item">Resultados Heteroevaluación</p>
  </div>
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <div fxFlex="99" class="mat-elevation-z6">
      <mat-accordion class="report-headers-align" multi>
        <mat-expansion-panel *ngFor="let item of heteroResults">
          <mat-expansion-panel-header>
            <mat-panel-title class="font-label">
              <strong>{{ item.course | titlecase }} - {{ item.group | titlecase }}</strong>
              <strong class="total-label">Total: {{ item.averagePerCourse | number : '1.2-2' }}</strong>
            </mat-panel-title>
            <mat-panel-description>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <!-- Tabla de calificaciones de los estudiantes -->
          <div fxFlex="99" class="table-responsive">
            <table class="table-answers">
              <thead class="header-active">
                <tr>
                  <th>Estudiantes</th>
                  <th>P 1</th>
                  <th>P 2</th>
                  <th>P 3</th>
                  <th>P 4</th>
                  <th>P 5</th>
                  <th>P 6</th>
                  <th>P 7</th>
                  <th>P 8</th>
                  <th>P 9</th>
                  <th>P10</th>
                  <th>P11</th>
                  <th>P12</th>
                  <th>P13</th>
                  <th>P14</th>
                  <th>P15</th>
                  <th>P16</th>
                  <th>P17</th>
                  <th>P18</th>
                  <th>P19</th>
                  <th>P20</th>
                </tr>
              </thead>
              <tbody *ngFor="let answer of item.ratins">
                <tr>
                  <td>{{ answer.stundent }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q1)}">{{ answer.q1 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q2)}">{{ answer.q2 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q3)}">{{ answer.q3 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q4)}">{{ answer.q4 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q5)}">{{ answer.q5 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q6)}">{{ answer.q6 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q7)}">{{ answer.q7 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q8)}">{{ answer.q8 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q9)}">{{ answer.q9 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q10)}">{{ answer.q10 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q11)}">{{ answer.q11 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q12)}">{{ answer.q12 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q13)}">{{ answer.q13 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q14)}">{{ answer.q14 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q15)}">{{ answer.q15 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q16)}">{{ answer.q16 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q17)}">{{ answer.q17 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q18)}">{{ answer.q18 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q19)}">{{ answer.q19 | number : '1.2-2' }}</td>
                  <td [ngStyle]="{'background-color': setColor(answer.q20)}">{{ answer.q20 | number : '1.2-2' }}</td>
                </tr>
              </tbody>
              <tfoot class="tfoot-active mat-elevation-z4">
                <tr>
                  <td class="font-label"><strong>Total</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q1 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q2 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q3 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q4 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q5 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q6 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q7 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q8 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q9 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q10 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q11 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q12 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q13 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q14 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q15 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q16 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q17 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q18 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q19 | number : '1.2-2' }}</strong></td>
                  <td class="font-label"><strong>{{ item.averages.q20 | number : '1.2-2' }}</strong></td>
                </tr>
              </tfoot>
            </table>
            <br>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </div>
  <br>
  <!-- Grafico por asignatura -->
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <p class="description-item">Heteroevaluación por asignatura</p>
  </div>
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <div fxFlex="98" class="mat-elevation-z6" #container>
      <ngx-charts-bar-vertical
        [view]="view"
        [scheme]="colorScheme"
        [results]="chartsCourse"
        [gradient]="gradient"
        [xAxis]="showXAxis"
        [yAxis]="showYAxis"
        [showXAxisLabel]="showXAxisLabel"
        [showYAxisLabel]="showYAxisLabel"
        [yAxisTicks]="yAxisTicksSize"
        [xAxisLabel]="xAxisLabel"
        [yAxisLabel]="yAxisLabel"
        [legend]="legend"
        [legendTitle]="legendTitle"
        [showDataLabel]="showDataLabel"
        [barPadding]="barPadding"
        (select)="onSelect($event)">
      </ngx-charts-bar-vertical>
    </div>
  </div>
  <br>
  <!-- Gráfico por pregunta -->
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <p class="description-item">Resultados por pregunta</p>
  </div>
  <div fxLayout="row" fxLayout.lt.sm="column" fxLayoutGap="20px">
    <div fxFlex="98" class="mat-elevation-z6" #container>
      <ngx-charts-bar-vertical
        [view]="view"
        [scheme]="colorScheme"
        [results]="chartsQuestions"
        [gradient]="gradient"
        [xAxis]="showXAxis"
        [yAxis]="showYAxis"
        [showXAxisLabel]="showXAxisLabel"
        [showYAxisLabel]="showYAxisLabel"
        [yAxisTicks]="yAxisTicksSize"
        [xAxisLabel]="xAxisLabel"
        [yAxisLabel]="yAxisLabel"
        [legend]="legendQuestion"
        [legendTitle]="legendTitle"
        [showDataLabel]="showDataLabel"
        [barPadding]="barPaddingQuestion"
        (select)="onSelect($event)">
      </ngx-charts-bar-vertical>
    </div>
  </div>

</div>



